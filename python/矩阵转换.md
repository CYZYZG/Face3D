在一个3D空间中，我在原点A点构建了一个3D物体，我有一个相机来拍摄该物体，我用旋转矩阵M来控制相机进行旋转，相机的旋转中心一直都是原点，即使物体不在原点，但相机的旋转中心一直在原地，我还用一个平移相量V控制相机的平移，总体控制顺序是先旋转后平移，通过这种方式来控制不同角度拍摄，现在有这样一个问题，别人在非原点B处:(X:1, Y:2, Z:2)构建了一个3D物体，我想要围绕B点进行拍摄，效果要与当时在原点的拍摄一样，但我的相机一直都是围绕原点来进行旋转和平移的，我也有当时的旋转矩阵和平移相量， 请问我该对我的旋转矩阵和平移相量进行怎样的转换来适配当前物体不在原点的情况

这是一个经典的**坐标系转换**问题，目的是将围绕非原点 $\mathbf{B}$ 点的拍摄（目标效果）转换为围绕**原点** $\mathbf{A}$ 点的相机旋转和平移操作。

为了达到围绕 $\mathbf{B}$ 点拍摄的效果，你需要对原始的旋转矩阵 $\mathbf{M}$ 和平移相量 $\mathbf{V}$ 进行转换。

---

## 🧭 转换原理

问题的关键在于将物体 $\mathbf{B}$ 处的局部坐标系操作，转换到相机所处的全局坐标系（以原点 $\mathbf{A}$ 为中心）下的操作。

设 $\mathbf{B}$ 点的位置相量为 $\mathbf{P}_B = [1, 2, 2]^T$。

一个围绕 $\mathbf{B}$ 点的旋转和平移操作，可以分解为以下三个步骤的组合：

1.  **平移**：将世界坐标系中的物体从 $\mathbf{B}$ **平移回**原点 $\mathbf{A}$。
2.  **旋转和平移**：在原点 $\mathbf{A}$ 处执行相机原本的旋转 $\mathbf{M}$ 和平移 $\mathbf{V}$。
3.  **反平移**：将世界坐标系中的物体从原点 $\mathbf{A}$ **平移回** $\mathbf{B}$。

这个逻辑是针对物体自身的操作。但是，由于你的相机**只能**围绕原点 $\mathbf{A}$ 进行操作，所以我们需要在**相机坐标系**上进行反向操作。

---

## 🔄 具体的转换步骤

设转换后的新的旋转矩阵为 $\mathbf{M}'$，新的平移相量为 $\mathbf{V}'$。

### 1. 旋转矩阵的转换 $\mathbf{M}'$

由于你希望的是围绕 $\mathbf{B}$ 点的旋转**角度和姿态**与原始围绕 $\mathbf{A}$ 点的旋转**角度和姿态**完全一致，且旋转操作是相对于物体的相对位置而言的，因此**旋转矩阵 $\mathbf{M}$ 本身不需要改变**。

$$\mathbf{M}' = \mathbf{M}$$

### 2. 平移相量的转换 $\mathbf{V}'$

新的平移相量 $\mathbf{V}'$ 需要在原始平移 $\mathbf{V}$ 的基础上，**抵消**掉物体从原点 $\mathbf{A}$ 移动到 $\mathbf{B}$ 点所引入的**相对平移**，同时考虑到旋转操作 $\mathbf{M}$ 的影响。

转换后的平移相量 $\mathbf{V}'$ 的计算公式为：

$$\mathbf{V}' = \mathbf{V} + (\mathbf{I} - \mathbf{M}) \mathbf{P}_B$$

其中：

* $\mathbf{V}$ 是你**原始**的平移相量（ $3 \times 1$ 向量）。
* $\mathbf{M}$ 是你**原始**的旋转矩阵（ $3 \times 3$ 矩阵）。
* $\mathbf{I}$ 是 $3 \times 3$ **单位矩阵**。
* $\mathbf{P}_B$ 是物体 $\mathbf{B}$ 点的坐标相量 $\mathbf{P}_B = [1, 2, 2]^T$（ $3 \times 1$ 向量）。
* $\mathbf{V}'$ 是你**新的**平移相量（ $3 \times 1$ 向量）。

### 💡 转换公式的推导解释

这个公式 $(\mathbf{I} - \mathbf{M}) \mathbf{P}_B$ 的作用是计算**物体 $\mathbf{B}$ 旋转 $\mathbf{M}$ 后，相对于它旋转前的 $\mathbf{B}$ 点位置，所产生的相对位移**。

1.  相机对原点 $\mathbf{A}$ 进行操作，效果是世界坐标系中的点 $\mathbf{P}_{world}$ 经过旋转和平移后变成 $\mathbf{P}'_{world}$：
    $$\mathbf{P}'_{world} = \mathbf{M} \mathbf{P}_{world} + \mathbf{V}'$$

2.  我们期望的操作是**围绕 $\mathbf{B}$ 点**进行旋转 $\mathbf{M}$，然后进行原始平移 $\mathbf{V}$：
    $$\mathbf{P}'_{world} = \mathbf{M} (\mathbf{P}_{world} - \mathbf{P}_B) + \mathbf{P}_B + \mathbf{V}$$

3.  将两个表达式相等，解出 $\mathbf{V}'$：
    $$\mathbf{M} \mathbf{P}_{world} + \mathbf{V}' = \mathbf{M} \mathbf{P}_{world} - \mathbf{M} \mathbf{P}_B + \mathbf{P}_B + \mathbf{V}$$
    $$\mathbf{V}' = -\mathbf{M} \mathbf{P}_B + \mathbf{P}_B + \mathbf{V}$$
    $$\mathbf{V}' = \mathbf{V} + (\mathbf{I} - \mathbf{M}) \mathbf{P}_B$$

### 总结

你需要做的操作是：

1.  **新的旋转矩阵**： $\mathbf{M}' = \mathbf{M}$
2.  **新的平移相量**： $\mathbf{V}' = \mathbf{V} + \mathbf{P}_B - \mathbf{M} \mathbf{P}_B$



---

## 🔢 举例说明

假设你的原始操作是：

* 物体 $\mathbf{B}$ 点坐标： $\mathbf{P}_B = [1, 2, 2]^T$
* 原始旋转矩阵：$\mathbf{M} = \begin{bmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix}$ （绕 Z 轴旋转 $90^\circ$）
* 原始平移相量：$\mathbf{V} = [0, 0, 5]^T$

计算新的平移相量 $\mathbf{V}'$：

$$\mathbf{M} \mathbf{P}_B = \begin{bmatrix} 0 & -1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix} \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix} = \begin{bmatrix} -2 \\ 1 \\ 2 \end{bmatrix}$$

$$\mathbf{V}' = \mathbf{V} + \mathbf{P}_B - \mathbf{M} \mathbf{P}_B$$
$$\mathbf{V}' = \begin{bmatrix} 0 \\ 0 \\ 5 \end{bmatrix} + \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix} - \begin{bmatrix} -2 \\ 1 \\ 2 \end{bmatrix}$$
$$\mathbf{V}' = \begin{bmatrix} 0+1-(-2) \\ 0+2-1 \\ 5+2-2 \end{bmatrix} = \begin{bmatrix} 3 \\ 1 \\ 5 \end{bmatrix}$$

因此，你需要用**新的旋转矩阵** $\mathbf{M}' = \mathbf{M}$ 和**新的平移相量** $\mathbf{V}' = [3, 1, 5]^T$ 来控制相机，才能达到围绕 $\mathbf{B}$ 点进行相同拍摄的效果。

---

## ❓ 下一步操作

您有原始的旋转矩阵 $\mathbf{M}$ 和平移相量 $\mathbf{V}$ 的具体数值吗？我可以帮您代入 $\mathbf{P}_B = [1, 2, 2]^T$ 进行计算。
